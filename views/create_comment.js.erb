$(document).scrollTop($('.div-comments').offset().top);
<% if nil == @comment.username or '' == @comment.username %>
$("#comment_user").tooltip({'placement': "bottom", 'trigger':'focus', 'title': '请输入用户名'});
$("#comment_user").focus();
<% elsif nil == @comment.comment or '' == @comment.comment %>
$("#comment_content").tooltip({'placement': "bottom", 'trigger':'focus', 'title': '请输入评论'});
$("#comment_content").focus();
<% else %>
$('.div-comments-wrap').prepend('<%= my_escape_javascript(partial("blog/comment", :locals => {comment: @comment})) %>');
$('.comment-user-form-input').val("");
$('textarea#comment_content').val("");

if ($('.md-preview').hasClass('has_preview')) {
  $('#comment_content_preview').addClass('hidden');
  $('#comment_content').removeClass('hidden');
  $('.md-preview').removeClass('has_preview');
  $('.md-preview').html('Preview');
  $('#comment_content_preview').html("");
}

$(".quote-tag").on('click', function(e) {
  if (e.stopped) return;
  e.preventDefault(); e.stopped = true;
  $.ajax({
   	url: '/comment/quote',
    data: {'id': $(this).attr('id')},
    method: 'get',
    contentType: 'text/plain',
    success: function(data) {
      var body = $('textarea#comment_content').val() + data;
      $('textarea#comment_content').val(body);
      $('textarea#comment_content').focus();
    },
    error: function(status, error) {
    }
  });
});

$('#spanCommentNum').html(parseInt($('#spanCommentNum').html()) + 1);
<% end %>